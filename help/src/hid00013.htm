<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
  <title>オプション設定 - 関連付け</title>
  <link rel="stylesheet" type="text/css" href="help.css">
  <object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
    <param name="Keyword" value="ExeCommands">
    <param name="Keyword" value="OpenByApp">
    <param name="Keyword" value="エイリアス">
    <param name="Keyword" value="コマンドファイル">
    <param name="Keyword" value="外部ツール">
    <param name="Keyword" value="関連付け">
    <param name="Keyword" value="追加メニュー">
  </object>
</head>

<body>

  <h1>オプション設定 - 関連付け</h1>
  <p>
    <a href="hid00005.htm#OpenByApp">OpenByApp</a> コマンドでファイルを開く際の、独自の関連付けを設定します。関連付け先には以下のものを指定できます。<br>
    なお、拡張子に <b>\</b> を指定すると、ディレクトリへの関連付けになります。<br>
    また <b>..</b> を指定すると、[..] 位置に対する関連付けになります。

  </p>
  <p>
    一つの拡張子に対して複数の関連付けを行うと、<b>OpenByApp</b>
    コマンド実行時にポップアップメニューで選択できます。メニュー項目の順番は一覧での表示と同じになります。なお、一覧で右クリックすると、カーソル位置の拡張子に対するポップアップメニューがテスト表示されます。
  </p>

  <dl class="indent1">
    <dt class="no_bg">アプリケーション</dt>
    <dd>アプリケーションを実行します。<br>
      <span class="btn_frame">...</span>ボタンを押すと実行ファイルを参照できます。また、ファイルドロップによる設定も可能です。ショートカット(.lnk)を選んだ場合はリンク先が設定されます(.exe
      の場合のみ)。<br>
      ファイル名の前に <span class="pram_text">:キャプション:</span> という形で文字列を指定すると、ポップアップメニュー表示時のキャプションとして用いられます(例:
      txt　:メモ帳(&amp;M):C:\Windows\notepad.exe)。アクセラレータキーを設定する場合は、文字列中の任意の位置に "&amp;" + 英数字
      という書式で記述してください。キャプションが無指定の場合は、実行ファイル名主部になります。<br>
      起動オプションなどを指定したい場合は、外部ツールの<b>エイリアス</b>や、<b>コマンド</b>(ExeCommands_SetExeFile 〜
      ShellExecute)または<b>コマンドファイル</b>を用いてください。
    </dd>

    <dt class="no_bg">エイリアス</dt>
    <dd><a href="hid00014.htm">追加メニュー</a>または<a href="hid00015.htm">外部ツール</a>の<b>エイリアス</b>(サブメニューの親項目は除く)を実行します。<br>
      エイリアス名の先頭に <b>$</b> を付けて指定してください。<br>
    </dd>

    <dt class="no_bg">コマンドファイル</dt>
    <dd>コマンドファイルを実行します。<br>
      ファイル名の先頭に <b>@</b> を付けて指定してください。ドライブ指定がない場合は <b>NyanFi</b> ディレクトリからの相対指定とみなされます。<br>
      <span class="btn_frame">...</span>ボタンを押すとコマンドファイルを参照できます。また、ファイルドロップによる設定も可能です。<br>
      なお、拡張子 <b>.nbt</b> に対してファイル名無しでただ <b>@</b> と指定すると、カーソル位置のコマンドファイルそのものが実行されます。<br>
      コマンドファイルの詳細は「<a href="hid00063.htm">ExeCommands コマンド</a>」のページを参照してください。<br>
    </dd>

    <dt class="no_bg">コマンド</dt>
    <dd><a href="hid00005.htm#ExeCommands">ExeCommands</a> コマンドを実行します。<br>
      <b>ExeCommands</b><span class="pram_text">_[:説明:]コマンド[:コマンド...]</span> の構文で指定してください。<br>
      説明は、ポップアップメニュー表示時のキャプションとして用いられます。<br>
      入力欄の内容が "ExeCommands_" で始まる場合、右クリックメニューからコマンド名を参照できます(<a href="hid00005.htm#CopyCmdName">→
        CopyCmdName</a>)。<br>
    </dd>

    <dt class="no_bg">セパレータ</dt>
    <dd>"-" (ハイフン)を指定すると、メニューのセパレータになります。<br>
      <br>
    </dd>
  </dl>

  <p>
    拡張子および関連付け先を指定して、<span class="btn_frame">追加</span>ボタンを押してください。<br>
    一覧で選択されている項目の内容を変更したい場合は<span class="btn_frame">変更</span>ボタンを、削除したい場合は<span
      class="btn_frame">削除</span>ボタンを押してください。また<span class="btn_frame">↑</span><span
      class="btn_frame">↓</span>ボタンで、項目を上下に移動できます。一覧にフォーカスがある場合は、 <span class="btn_frame">Shift</span>+<span
      class="btn_frame">Ctrl</span>+<span class="btn_frame">↑</span>/<span class="btn_frame">↓</span>キーで項目の上下移動、<span
      class="btn_frame">DEL</span>キーで削除が可能です。なお、項目の移動はドラッグ＆ドロップでもできます(上下端で自動スクロール)。<br>
    <img src="chkbox.png" alt=""> <b>ソート</b> をチェックしていると、<span class="btn_frame">追加</span>、<span
      class="btn_frame">変更</span>の際に、一覧が拡張子順にソートされます。同じ拡張子内の項目の順番は変わりません。
  </p>

  <p>
    なお、関連付けされていないファイルを開こうとした場合の動作は、<a href="hid00019.htm#OpenByApp">オプション設定 - コマンド</a> で選択できます。
  </p>

  <hr><br>
  <b>例</b>: .jpg ファイルに対する動作をポップアップメニューで選択<br>
  <div class="indent1">
    <pre class="inp_box">
jpg  :Photoshop:C:\Program Files (x86)\Adobe\Photoshop\Photoshp.exe
jpg  $画像処理ユーティリティ
jpg  ExeCommands_:Exif情報出力:SetExeFile_D:\hoge\exiftool.exe: SetExeParam_"-w txt $F": ShellExecute
jpg  -
jpg  ExeCommands_:画像の変換:ConvertImage
jpg  ExeCommands_:Exif撮影日時に:SetExifTime
jpg  ExeCommands_:Exif情報の削除:DelJpgExif
jpg  -
jpg  @画像の振り分け.nbt
</pre>
  </div>
  <br>

  <b>例</b>: [..] 位置での動作をポップアップメニューで選択<br>
  <div class="indent1">
    <pre class="inp_box">
..  ExeCommands_:PowerShell:PowerShell
..  ExeCommands_:コマンドプロンプト:CommandPrompt
..  ExeCommands_:エクスプローラ:OpenByExp
..  ExeCommands_:Git:FileRun_"C:\Program Files\Git\git-bash.exe"
-
..  ExeCommands_:全ディレクトリの容量計算:CalcDirSizeAll_SG
</pre>
  </div>

  <br><br>

</body>

</html>
