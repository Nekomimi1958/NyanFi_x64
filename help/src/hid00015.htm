<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
  <title>オプション設定 - 外部ツール</title>
  <link rel="stylesheet" type="text/css" href="help.css">
  <object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
    <param name="Keyword" value="ExeExtTool">
    <param name="Keyword" value="ExPopupMenu">
    <param name="Keyword" value="アクセラレータキー">
    <param name="Keyword" value="エイリアス">
    <param name="Keyword" value="外部ツール">
    <param name="Keyword" value="環境変数">
  </object>
</head>

<body>

  <h1>オプション設定 - 外部ツール</h1>

  <p>
    ここで設定した項目は「<b>ツールメニュー</b>」の末尾に追加されます。<br>
    また <a href="hid00005.htm#ExPopupMenu">ExPopupMenu</a> コマンドを実行すると、<a href="hid00014.htm">オプション設定 - 追加メニュー</a>
    で設定したメニュー項目を合わせて、一つのポップアップメニューとして表示されます。<br>
    <b>エイリアス</b>を設定しておくと、それを<a href="hid00016.htm">キー</a>や<a href="hid00068.htm">ツールボタン</a>に割り当てたり、<a
      href="hid00013.htm">関連づけ</a>や<a href="hid00021.htm">イベント</a>、<a
      href="hid00012.htm#EtcEditor">その他のエディタ</a>でも利用したりできます。<br>
    また<b>キャプション</b>にアクセラレータキーを設定しておけば、<a href="hid00005.htm#ExeExtTool">ExeExtTool</a> コマンドのパラメータとして呼び出すことも可能です。<br>
    外部ツールの最大登録数は100です。
  </p>
  <p>
    <b>キャプション</b>、<b>実行ファイル</b>、必要なら <b>パラメータ</b>、<b>作業ディレクトリ</b>、<b>エイリアス</b> を指定して、<span
      class="btn_frame">追加</span>ボタンを押してください。<br>
    <b>実行ファイル</b> の<span
      class="btn_frame">...</span>ボタンやファイルドロップでショートカット(.lnk)を選んだ場合は、その内容に基づいて、キャプション、実行ファイル、パラメータ、作業ディレクトリが設定されます(リンク先が
    .exe の場合のみ)。<br>
    <b>アクセラレータキー</b>を設定する場合は、キャプション文字列中に &quot;&amp;&quot; + 英数字 という書式で記述してください(例: &quot;ファイルを比較(&amp;F)&quot;)。<br>
    キャプションを &quot;-&quot; (ハイフン)にすると<b>セパレータ</b>になります。<br>
    キャプションの先頭が &quot;&gt;&quot; の場合、<b>サブメニュー</b>が作られ、以降の項目はその階層に入ります。キャプションを &quot;&lt;&quot; とすると階層が戻ります。<br>
    なお、サブメニューの親項目に<b>エイリアス</b>を設定しておくと、呼び出し時にそのサブメニューだけがポップアップ表示されます(関連付けやその他のエディタは除く)。
  </p>
  <p>
    一覧のチェックボックスで、メニューへの表示/非表示を切り替えられます。非表示になっていても、アクセラレータキーによる <b>ExeExtTool</b>
    コマンドでの呼び出しや、<b>エイリアス</b>によるキーやツールボタンへの割り当ては可能です。
  </p>

  <p>
    一覧で選択されている項目の内容を変更したい場合は<span class="btn_frame">変更</span>ボタンを、削除したい場合は<span
      class="btn_frame">削除</span>ボタンを押してください。また<span class="btn_frame">↑</span>/<span
      class="btn_frame">↓</span>ボタンで項目を上下に移動できます。一覧にフォーカスがある場合は、 <span class="btn_frame">Shift</span>+<span
      class="btn_frame">Ctrl</span>+<span class="btn_frame">↑</span>/<span class="btn_frame">↓</span>キーで項目の上下移動、<span
      class="btn_frame">DEL</span>キーで削除が可能です。なお、項目の移動はドラッグ＆ドロップでもできます(上下端で自動スクロール)。<br>
    なお、<b>エイリアス</b>を改名すると、それを用いているキー設定や関連付けの内容にも反映されます。
  </p>
  <p>
    パラメータには、以下の書式文字列が使えます。<br>
    　<b>$F</b>　カレント側で選択されている(無ければカーソル行の)パス付ファイル名<br>
    　<b>$C</b>　カーソル行のパス付ファイル名(選択なしの場合 $F と同じ)<br>
    　<b>$B</b>　$F からパス名を除いたファイル名部分<br>
    　<b>$N</b>　$B から拡張子を除いたファイル名主部<br>
    　<b>$O</b>　反対側で選択されているパス付ファイル名<br>
    　<b>$P</b>　カレントパス名 (末尾の \ は無し)<br>
    　<b>$Q</b>　反対パス名 (末尾の \ は無し)<br>
    　<b>$R</b>　反対側で選択中なら $O、無選択なら $Q\$B (<a href="hid00005.htm#DiffDir">ディレクトリの比較</a>の結果リストでは反対側カーソル位置のパス付ファイル名)<br>
    　<b>$X</b>　<b>NyanFi</b> の起動パス(末尾の \ は無し)<br>
    　<b>$D</b>　<b>NyanFi</b> の起動ドライブ(末尾の \ は無し、例: &quot;D:&quot;)<br>
    　<b>$$</b>　$ そのもの<br>

    名前に空白が含まれている場合はダブルクォーテーションで囲まれます。その場合 $P や $Q の直後に文字列があったら、それを含んだ全体が囲まれます。<br>
    例えばカレントが D:\hoge hogo の場合、$P\test.txt は &quot;D:\hoge hogo\test.txt&quot; になります。
  </p>
  <p>
    <b>$F</b>、<b>$O</b>、<b>$R</b> に該当するファイルがアーカイブ内だった場合は一時解凍して渡されます。<br>
    <b>$X</b>、<b>$D</b>、<b>$$</b> は、実行ファイルの指定にも使用できます。<br>
    <b>$P</b>、<b>$Q</b>、<b>$X</b>、<b>$D</b>、<b>$$</b> は、作業ディレクトリの指定にも使用できます。<br>
    <br>
    なお、実行ファイル、パラメータ、作業ディレクトリには、&quot;%変数名%&quot; という書式で環境変数が使えます。<br>
  </p>
  <br>

  <p class="indent1">
    <b>例</b>:<br>
    キャプション <span class="inp_box">左右の同名ファイルを比較</span><br>
    実行ファイル <span class="inp_box">C:\Program Files\WinMerge\WinMergeU.exe</span><br>
    パラメータ <span class="inp_box">$F $R</span><br>
    <br>
    キャプション <span class="inp_box">ファイルダンプ</span><br>
    実行ファイル <span class="inp_box">D:\Embarcadero\RAD Studio\10.0\bin\tdump.exe</span><br>
    パラメータ <span class="inp_box">$F $P\$N.txt</span><br>
    <br>
    キャプション <span class="inp_box">7z超高圧縮</span><br>
    実行ファイル <span class="inp_box">C:\Program Files\7-Zip\7z.exe</span><br>
    パラメータ <span class="inp_box">a -t7z -r- -mx=9 -- $Q\$N.7z $F</span><br>
  </p>
  <br><br>

</body>

</html>