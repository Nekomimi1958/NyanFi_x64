<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>Git の利用について</title>
<link rel="stylesheet" type="text/css" href="help.css">
<object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
	<param name="Keyword" value="Git">
	<param name="Keyword" value="Git for Windows">
	<param name="Keyword" value="git.exe">
	<param name="Keyword" value="GitViewer">
	<param name="Keyword" value="Gitビュアー">
	<param name="Keyword" value="OpenGitURL">
	<param name="Keyword" value="SelGitChanged">
	<param name="Keyword" value="ファイル情報">
	<param name="Keyword" value="一覧ダイアログ">
</object>
</head>

<body>

<h1>Git の利用について</h1>
<p>
<b>git.exe</b> (Git for Windows) がインストールされてると、後述の Git 関連機能を利用できます。<br>
標準的な場所(%PROGRAMFILES%\Git\cmd など)にインストールされている場合は自動的に検出されますが、そうでない場合は <a href="hid00024.htm#Other">オプション設定 - 一般2 - その他</a> で設定してください。<br>
</p>
<br>

<h3>ファイル情報の表示</h3>
<p>直下に .git があるディレクトリ、またはその中の [..] 位置では、ファイル情報に以下の項目が表示されます。</p>

<dl>
<dt class="no_bg">Remote URL
<dd>リモートリポジトリのURL(https://〜)です。<br>
.git/config 内の [remote &quot;origin&quot;] の内容から想定されるURLを表示しています。<br>
GitHub、GitLab、BitBucket では多分大丈夫だと思います。<br>
<a href="hid00005.htm#OpenGitURL">OpenGitURL</a> コマンドを実行すると、カーソル位置項目に対応するページをブラウザで開けます(ファイル情報の右クリックメニューからも可能)。<br>

<dt class="no_bg">HEAD
<dd>現在作業中のブランチに対するシンボリック参照です(.git/HEAD の内容)。

<dt class="no_bg">COMMIT_EDITMSG
<dd>直前のコミットメッセージです(.git/COMMIT_EDITMSG の内容)。

<dt class="no_bg">STATUS
<dd>git status --porcelain コマンドの取得結果から、フラグごとのファイル数(インデックス/ワーキングツリー)を表示します。<br>
例えば、ワーキングツリーに2個の変更されたファイルがある場合、&quot;M:_/2&quot; と表示されます。<br>
<a href="hid00005.htm#SelGitChanged">SelGitChanged</a> コマンドを実行すると、カレントで変更されているファイル(フラグが &quot;?&quot; 以外)が選択されます。<br>
</dl>

<p>なおリポジトリの作業ディレクトリ下で、トップの [..] 以外の項目については、<b>Remote URL</b> のみが表示されます。</p>

<p>ファイル情報の右クリックメニュー「<b>この項目を隠す</b>」で非表示になっている項目は取得を試みません。<b>STATUS</b> などで取得に時間がかかって操作が滞るような場合には非表示にしてみてください。</p>

<div class="indent1">
<b>表示例</b><br>
<pre class="example_box">
     Remote URL: https://github.com/Nekomimi1958/NyanFi_x64
           HEAD: ref: refs/heads/master
 COMMIT_EDITMSG: v13.08 Add Git command
         STATUS: M:_/2
</pre>
</div>
<br>

<h3 id="GitViewer">Gitビュアー</h3>
<div class="spc_box_p">
Gitの作業ディレクトリ内で <a href="hid00005.htm#GitViewer">GitViewer</a> コマンドを実行すると、<b>Gitビュアー</b>が表示されます。<br>
画面の左側にはブランチ一覧があります。<br>
右クリックメニューから、チェックアウト(ダブルクリックや<span class="btn_frame">ENTER</span>キーでも可能)、ブランチの作成/削除/改名、マージ、タグ付け、リセットを行えます。<br>
</div>

<div class="spc_box_p">
画面右側の上部にはHEAD位置のコミット履歴が表示されます。<br>
デフォルトでは、表示されるコミット履歴数が30に制限されています。これを変更したい場合は、<b>GitViewer</b> コマンドの <b>N</b>〜 パラメータで指定してください。<br>
コミットを選択すると、下部にその差分の概略が表示されます。<br>
右クリックメニューからは、ブランチ名/コミットIDのコピー、ZIPアーカイブの作成(<a href="hid00005.htm#Pack">Pack</a> コマンドのキーでも可能)などを行えます。<br>
</div>
<div class="spc_box_p">
下部の差分ファイル一覧では、右クリックメニューから diffツールを起動できます。<br>
カーソル位置のファイルと、直前のコミットの同名ファイルとの差分を、git に設定されている外部ツールで表示します。<br>
ファイル名が変更されていたりするとエラーになるので注意してください。<br>
</div>

<div class="spc_box_p">
カーソル移動などは、ファイラーやテキストビュアーで割り当てられているのと同じキー操作でできます。<br>
ブランチ一覧/コミット履歴間のフォーカス移動は、<a href="hid00005.htm#ToLeft">ToLeft</a> / <a href="hid00005.htm#ToRight">ToRight</a>、<a href="hid00005.htm#ToParentOnLeft">ToParentOnLeft</a> / <a href="hid00005.htm#ToParentOnRight">ToParentOnRight</a> コマンドが割り当てられているキーや、<span class="btn_frame">←</span> / <span class="btn_frame">→</span>キーで行えます。<br>
また、コミット履歴/差分ファイル一覧間は、<a href="hid00005.htm#ToRight">ToRight</a> / <a href="hid00005.htm#ToParentOnRight">ToParentOnRight</a> コマンドのキーや <span class="btn_frame">→</span>キーで移動できます。<br>
</div>

<div class="spc_box_p">
ブランチ一覧、コミット履歴にはリストの、差分概略にはテキストプレビューのフォント・配色が用いられます。<br>
また差分概略では、ファイル名部分に拡張子別配色を適用できます(右クリックメニューから設定)。<br>
その他 Git 固有の配色は、<a href="hid00023.htm">オプション設定 - フォント・配色</a> で指定してください。<br>
</div>
<br>

<h3>Git 補助コマンドの利用</h3>
<p>
<a href="hid00063.htm#Git">ExeCommands コマンドの Git 補助コマンド</a> を実行すると、カレントを作業ディレクトリとして、指定したコマンド/パラメータで git.exe が実行されます。<br>
これによって、コンソールを開かなくても <b>NyanFi</b> から直接 Git コマンドを利用できます。<br>
結果は、ログおよび定義済み変数 <b>Buffer</b> に出力されます。<br>
なお Git 補助コマンドの結果(1行目が &quot;$ git 〜&quot;)を<a href="hid00073.htm">一覧ダイアログ</a>で表示した場合、行頭部の &quot;<b>*</b>&quot;、&quot;<b>|</b>&quot;、&quot;<b>/</b>&quot;、&quot;<b>\</b>&quot;、&quot;<b>_</b>&quot; からなる部分はグラフィック表示になります(* は「見出しの文字色」の●印に、線は「罫線の色」で描画)。また &quot;<b>-</b>&quot; で始まる行は赤で、&quot;<b>+</b>&quot; で始まる行は緑で表示されます。
</p>

<div class="indent1">
<b>使用例</b><br>
入力したURLのリポジトリをカレントにクローン化<br>
<pre class="example_box">
Input_":クローン:URL:URL"
Test_URL!=""
IfTrue
  Git_"clone %URL%"
EndIf
</pre>

リポジトリの状態とコミット履歴をまとめて一覧ダイアログで表示<br>
<pre class="example_box">
IfNotGit
  Warn_"Gitの作業ディレクトリではありません。"
  Exit
Endif

Git_status --porcelain --branch
Set_RES=%Buffer%
Add_RES<<""

Git_log --graph --decorate --oneline
Add_RES<<%Buffer%

Set_Buffer=%RES%
ListBuffer_"Git Status/Log - %CurPath%"
</pre>

すべての変更内容をインデックスに追加し、入力したメッセージでコミット<br>
<pre class="example_box">
Input_":%CurPath%:コミットメッセージ:MSG"
Test_MSG==""
IfTrue_Exit

Git_add -A
Set_RES=%Buffer%
Add_RES<<""

Git_commit -m "%MSG%"
Add_RES<<%Buffer%

Set_Buffer=%RES%
ListBuffer_"Git Add/Commit - %CurPath%"
</pre>

ポップアップメニューでブランチを選んでチェックアウト
<pre class="example_box">
Git_branch
ReplaceBuffer_/^\$ git .*\r\n/=""
PopupMenu_Buffer
Test_MenuIndex!=0
IfTrue
  Set_Buffer=%MenuStr%
  MatchBuffer_/^\*/
  IfFalse
    Hint_"checkout %MenuStr%"
    Git_"checkout %MenuStr%"
  EndIf
EndIf
Exit
</pre>

</div>
<br><br>

</body>
</html>
